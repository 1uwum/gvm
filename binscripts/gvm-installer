#!/bin/bash
GVM_DEST=~
ENV_FILE=~/.bashrc
SRC_REPO=git://github.com/moovweb/gvm.git

if [ -d $GVM_DEST/.gvm ]; then
  echo "Already installed!"
else
  cd $GVM_DEST && git clone $SRC_REPO .gvm > /dev/null 2>&1
  rm -rf $GVM_DEST/.gvm/.git
  if [ -e ~/.bashrc ]; then
    cat ~/.bashrc | grep "\[\[ -s \"\$HOME/.gvm/scripts/gvm\" ]] && source \"\$HOME/.gvm/scripts/gvm\"" > /dev/null 2>&1
    if [ $? -ne 0 ]; then
      echo '[[ -s "$HOME/.gvm/scripts/gvm" ]] && source "$HOME/.gvm/scripts/gvm"' >> $ENV_FILE
    fi
  else
    echo 'This must be a Mac... put this line in you profile and source it!'
    echo
    echo ' [[ -s "$HOME/.gvm/scripts/gvm" ]] && source "$HOME/.gvm/scripts/gvm"'
    echo
    echo "Maybe send me the file name and I'll look for it next time :)"
    echo
  fi
  source ~/.bashrc
  echo "Installed GVM v$GVM_VERSION"
fi
